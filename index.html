<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-X4NYG8BBPX"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-X4NYG8BBPX');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spelling Bee Minimal Hint - Daily Puzzle Helper</title>
    <meta name="description" content="A spoiler-free hint tool for NYT Spelling Bee. Get the count of matching words without revealing answers. Type letters or use wildcards to see how many words match your guess.">
    <meta name="keywords" content="spelling bee, nyt spelling bee, spelling bee hints, spelling bee helper, spelling bee solver, word game helper, puzzle hints">
    <meta name="author" content="Spelling Bee Minimal Hint">
    <meta property="og:title" content="Spelling Bee Minimal Hint - Daily Puzzle Helper">
    <meta property="og:description" content="A spoiler-free hint tool for NYT Spelling Bee. See how many words match without revealing answers.">
    <meta property="og:type" content="website">
    <style>
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            height: 100%;
            touch-action: manipulation;
        }
        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            -webkit-text-size-adjust: 100%;
        }
    </style>
    <style>
        .hive {
            position: relative;
            width: 190px;
            height: 190px;
            margin-top: 20px;
        }
        .hex {
            position: absolute;
            width: 64px;
            height: 56px;
            background: #e6e6e6;
            clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        .hex:hover { background: #d0d0d0; }
        .hex.center { background: #f7da21; }
        .hex.center:hover { background: #e6c91a; }
        .hex.pos-0 { left: 66px; top: 0; }
        .hex.pos-1 { left: 12px; top: 32px; }
        .hex.pos-2 { left: 120px; top: 32px; }
        .hex.pos-c { left: 66px; top: 64px; }
        .hex.pos-3 { left: 12px; top: 96px; }
        .hex.pos-4 { left: 120px; top: 96px; }
        .hex.pos-5 { left: 66px; top: 128px; }
        #word { font-size: 24px; margin: 20px 0; min-height: 30px; text-align: center; }
        #count { font-size: 20px; margin-left: 10px; }
        #definition {
            margin-top: 20px;
            padding: 15px;
            max-width: 400px;
            text-align: left;
            font-size: 14px;
            line-height: 1.5;
            display: none;
        }
        #definition.visible { display: block; }
        #definition .word-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        #definition .phonetic {
            color: #666;
            font-style: italic;
            margin-bottom: 10px;
        }
        #definition .part-of-speech {
            font-weight: bold;
            color: #444;
            margin-top: 10px;
        }
        #definition .def-text {
            margin: 5px 0 5px 15px;
        }
        #definition .synonyms {
            color: #666;
            font-size: 12px;
            margin-left: 15px;
        }
        #stats {
            margin-top: 20px;
            padding: 10px 20px;
            background: #f5f5f5;
            border-radius: 8px;
            font-size: 14px;
            color: #444;
        }
        #stats span {
            font-weight: bold;
            color: #222;
        }
        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .btn {
            padding: 10px 20px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        .btn:hover { background: #f0f0f0; }
        .btn.round {
            width: 44px;
            height: 44px;
            padding: 0;
            border-radius: 50%;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .title {
            font-family: Georgia, 'Times New Roman', Times, serif;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">Spelling Bee Minimal Hint</h1>
        <div><span id="word"></span><span id="count"></span></div>
        <div id="letters" class="hive"></div>
        <div class="buttons">
            <button class="btn" id="deleteBtn">Delete</button>
            <button class="btn round" id="wildBtn" style="font-size: 24px;">✱</button>
            <button class="btn" id="shuffleBtn">Shuffle</button>
        </div>
        <div id="stats"></div>
        <div id="definition"></div>
    </div>
    
    <script>
        let answers = [];
        let validLetters = [];
        let centerLetter = '';
        let currentWord = '';
        let puzzleKey = '';
        let stats = { attempts: [], found: [] };
        
        function getPuzzleKey(letters) {
            return 'sbstats_' + [...letters].sort().join('');
        }
        
        function loadStats() {
            if (!puzzleKey) return;
            const saved = localStorage.getItem(puzzleKey);
            if (saved) {
                stats = JSON.parse(saved);
            } else {
                stats = { attempts: [], found: [] };
            }
            updateStatsDisplay();
        }
        
        function saveStats() {
            if (!puzzleKey) return;
            localStorage.setItem(puzzleKey, JSON.stringify(stats));
            updateStatsDisplay();
        }
        
        function updateStatsDisplay() {
            const el = document.getElementById('stats');
            if (!el) return;
            el.innerHTML = `Attempts: <span>${stats.attempts.length}</span> | Found: <span>${stats.found.length}</span>`;
        }
        
        function trackWord(word) {
            // Only count words >= 4 letters without wildcards
            if (word.length >= 4 && !word.includes('*')) {
                let changed = false;
                // Track attempt if not already tracked
                if (!stats.attempts.includes(word)) {
                    stats.attempts.push(word);
                    changed = true;
                }
                // Track found if it's a match
                if (answers.includes(word) && !stats.found.includes(word)) {
                    stats.found.push(word);
                    changed = true;
                }
                if (changed) saveStats();
            }
        }
        
        function updateDisplay() {
            const value = currentWord.toLowerCase();
            const wordEl = document.getElementById('word');
            wordEl.textContent = value.toUpperCase();
            const isExactMatch = answers.includes(value);
            wordEl.style.fontWeight = isExactMatch ? 'bold' : 'normal';
            const letters = value.replace(/\*/g, '');
            
            if (letters.length < 1) {
                document.getElementById('count').textContent = '';
                document.getElementById('definition').className = '';
                return;
            }
            
            if (value.includes('*')) {
                const pattern = '^' + value.replace(/\*/g, '.*') + '$';
                const regex = new RegExp(pattern);
                const matches = answers.filter(a => regex.test(a));
                document.getElementById('count').textContent = matches.length;
            } else {
                const matches = answers.filter(a => a.startsWith(value));
                document.getElementById('count').textContent = matches.length;
            }
            
            // Track attempts and found words
            trackWord(value);
            
            // Fetch definition on exact match
            if (isExactMatch) {
                fetchDefinition(value);
            } else {
                document.getElementById('definition').className = '';
            }
        }
        
        function addLetter(letter) {
            const l = letter.toLowerCase();
            if (l === '*' || validLetters.includes(l)) {
                currentWord += l;
                updateDisplay();
            }
        }
        
        function deleteLetter() {
            currentWord = currentWord.slice(0, -1);
            updateDisplay();
        }
        
        async function fetchDefinition(word) {
            const defEl = document.getElementById('definition');
            defEl.className = '';
            defEl.innerHTML = '';
            
            try {
                const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`);
                if (!response.ok) {
                    defEl.innerHTML = '<em>No definition found</em>';
                    defEl.className = 'visible';
                    return;
                }
                
                const data = await response.json();
                const entry = data[0];
                
                let html = `<div class="word-title">${entry.word}</div>`;
                if (entry.phonetic) {
                    html += `<div class="phonetic">${entry.phonetic}</div>`;
                }
                
                for (const meaning of entry.meanings) {
                    html += `<div class="part-of-speech">${meaning.partOfSpeech}</div>`;
                    for (const def of meaning.definitions.slice(0, 2)) {
                        html += `<div class="def-text">• ${def.definition}</div>`;
                        if (def.synonyms && def.synonyms.length > 0) {
                            html += `<div class="synonyms">Synonyms: ${def.synonyms.slice(0, 3).join(', ')}</div>`;
                        }
                    }
                }
                
                defEl.innerHTML = html;
                defEl.className = 'visible';
            } catch (error) {
                console.error('Error fetching definition:', error);
            }
        }
    </script>
    
    <script>
        async function fetchSpellingBeeAnswers() {
            try {
                const response = await fetch('https://spelling-bee-minimal-hint.onrender.com/proxy?url=https://www.nytimes.com/puzzles/spelling-bee', {
                    headers: {
                        'Origin': 'https://www.nytimes.com'
                    }
                });
                const html = await response.text();
                
                const startMarker = 'window.gameData = ';
                const startIdx = html.indexOf(startMarker);
                if (startIdx === -1) {
                    console.log('No gameData found');
                    return;
                }
                
                const jsonStart = startIdx + startMarker.length;
                let braceCount = 0;
                let jsonEnd = jsonStart;
                
                for (let i = jsonStart; i < html.length; i++) {
                    if (html[i] === '{') braceCount++;
                    if (html[i] === '}') braceCount--;
                    if (braceCount === 0) {
                        jsonEnd = i + 1;
                        break;
                    }
                }
                
                const jsonStr = html.slice(jsonStart, jsonEnd);
                const gameData = JSON.parse(jsonStr);
                answers = gameData.today.answers;
                validLetters = gameData.today.validLetters;
                centerLetter = gameData.today.centerLetter;
                
                // Initialize stats for this puzzle
                puzzleKey = getPuzzleKey(validLetters);
                loadStats();
                
                const others = validLetters.filter(l => l !== centerLetter);
                
                const hexes = [
                    { letter: others[0], pos: 'pos-0' },
                    { letter: others[1], pos: 'pos-1' },
                    { letter: others[2], pos: 'pos-2' },
                    { letter: centerLetter, pos: 'pos-c center' },
                    { letter: others[3], pos: 'pos-3' },
                    { letter: others[4], pos: 'pos-4' },
                    { letter: others[5], pos: 'pos-5' },
                ];
                
                document.getElementById('letters').innerHTML = hexes.map(h => 
                    `<div class="hex ${h.pos}" data-letter="${h.letter}">${h.letter}</div>`
                ).join('');
                
                document.querySelectorAll('.hex').forEach(hex => {
                    hex.addEventListener('click', () => {
                        addLetter(hex.dataset.letter);
                    });
                });
                
                document.getElementById('deleteBtn').addEventListener('click', () => {
                    deleteLetter();
                });
                
                document.getElementById('shuffleBtn').addEventListener('click', () => {
                    const positions = ['pos-0', 'pos-1', 'pos-2', 'pos-3', 'pos-4', 'pos-5'];
                    const outerHexes = document.querySelectorAll('.hex:not(.center)');
                    const shuffled = [...positions].sort(() => Math.random() - 0.5);
                    outerHexes.forEach((hex, i) => {
                        hex.className = 'hex ' + shuffled[i];
                    });
                });
                
                document.getElementById('wildBtn').addEventListener('click', () => {
                    addLetter('*');
                });
                
                console.log('Answers:', answers);
                return answers;
            } catch (error) {
                console.error('Error fetching:', error);
            }
        }
        
        fetchSpellingBeeAnswers();
    </script>
</body>
</html>
